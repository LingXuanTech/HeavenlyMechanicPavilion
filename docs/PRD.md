# 股票 Agents 监控大屏 PRD

> 最后更新: 2026-02-02

## 1. 项目愿景

开发一个基于 **TradingAgents** 框架的专业级金融情报系统。通过编排一组专业、模块化的 AI Agent 团队，进行对抗性辩论、深度数据挖掘和实时联网搜索，为投资者提供从"发现机会"到"决策执行"的全链路支持，并以交易室监控大屏的形式直观展示。

## 2. 核心角色与 Agent 架构 (18 Agents)

系统采用多 Agent 协作模式，每个 Agent 作为一个独立的节点运行在 LangGraph 编排层中。

### 2.1 🎯 规划者 (Planner Agent) — ✅ 已实现
- **职责**: 根据股票特征（市场、成交量、财报季、新闻热度）自适应选择分析师组合。
- **能力**: 元数据分析、动态路由、A股特色分析师激活。
- **场景**: L2 深度分析时自动优化分析师配置。

### 2.2 🕵️ 发现者 (Scout Agent) — ✅ 已实现
- **职责**: 根据自然语言指令扫描市场。
- **能力**: 实时联网搜索 (DuckDuckGo/Google)、语义理解、Ticker 自动验证与过滤。
- **场景**: 响应"寻找今日因 AI 概念大涨的股票"等时效性需求。

### 2.3 🔍 分析师团队 (Analyst Team) — ✅ 已实现
- **技术分析师**: K 线形态识别、指标计算（RSI, MACD 等）。
- **基本面分析师**: 财报深度解析、估值模型、行业催化剂分析。
- **宏观分析师**: 追踪美联储利率、GDP、CPI 等宏观指标对市场的传导影响。
- **舆情分析师**: 监控 Reddit、Twitter 等社交媒体热度，捕捉散户情绪与逼空信号。
- **情绪分析师**: 市场情绪量化分析。
- **政策分析师**: 自动关联各国立法、补贴政策对特定板块的影响。
- **资金流向分析师**: 龙虎榜/北向资金追踪（A股特色）。

### 2.4 ⚔️ 研究员辩论 (Researcher Debate) — ✅ 已实现
- **多方研究员 (Bull Agent)** & **空方研究员 (Bear Agent)**。
- **机制**: 基于 Analyst 提供的报告进行对抗性辩论，消除 AI 幻觉，暴露潜在风险。

### 2.5 🛡️ 风险经理 (Risk Manager) — ✅ 已实现
- **职责**: 下行风险评估，三方辩论（激进/保守/中立）。
- **输出**: 0-10 风险评分、波动率评估、流动性预警。

### 2.6 👨‍💼 基金经理 (Trader) — ✅ 已实现
- **职责**: 综合所有 Agent 输入，做出最终决策。
- **输出**: 信号（Strong Buy/Hold/Sell）、入场区间、止盈止损位。

### 2.7 📈 扩展角色 (Specialized Agents)

| Agent | 状态 | 说明 |
|-------|------|------|
| 回测专家 (BacktestAgent) | ✅ 已实现 | 历史模拟，验证策略胜率 |
| 组合管家 (PortfolioAgent) | ✅ 已实现 | 持仓相关性分析，调仓建议 |
| 央行 NLP 分析师 | ✅ 已实现 | 央行会议纪要语义分析 |
| 跨资产分析师 | ✅ 已实现 | 黄金/原油/债市联动分析 |
| 执行助手 (ExecutionAgent) | 🔮 计划中 | 对接模拟盘/实盘 API |
| 筹码追踪员 (WhaleWatcher) | 🔮 计划中 | 13F、内部人交易、L2 大单流向 |

## 3. 核心功能需求

### 3.1 智能发现与搜索 — ✅ 已实现
- **实时联网**: 支持基于实时新闻和社交热点的股票发现（DuckDuckGo/Google）。
- **Ticker 自动验证**: 搜索结果自动验证有效性。
- **政策映射**: 自动关联政策对特定板块的影响。

### 3.2 深度分析与回测 — ✅ 已实现
- **分级分析**: L1 快速扫描 (15-20s) / L2 深度研究 (30-60s)。
- **对抗性分析**: 多维度数据支撑的深度研报生成。
- **策略回测**: 支持对 Agent 历史决策进行自动评分和胜率统计。
- **跨资产联动**: 监控大宗商品、债市对股市的前导影响。

### 3.3 A股特色功能 — ✅ 已实现
- **龙虎榜分析**: 机构/游资席位追踪。
- **北向资金**: 外资流入流出监控。
- **限售解禁**: 解禁日程与影响分析。
- **政策-行业映射**: 政策变化对行业板块的影响分析。
- **央行 NLP**: 央行文本语义分析。

### 3.4 监控大屏与交互 — ✅ 已实现
- **实时工作流可视化**: 展示 Agent 思考过程（SSE 推送）。
- **Agentic UI**: 根据分析结论动态生成前端组件。
- **音频简报**: Gemini TTS 语音合成主播稿。
- **全球指数监控**: 实时追踪全球市场指数。

### 3.5 认证与安全 — ✅ 已实现
- **三重认证**: JWT + OAuth 2.0 (Google/GitHub) + WebAuthn/Passkey。
- **动态 AI 配置**: 通过 UI 动态配置 LLM 提供商。
- **API 密钥加密**: Fernet 对称加密存储。

### 3.6 记忆与反思系统 — ✅ 已实现
- **分层记忆**: ChromaDB 向量数据库，支持按 symbol/宏观周期/技术形态检索。
- **自动反思**: Agent 决策后自动生成反思，注入后续分析。
- **经验增长**: 历史记录避免重复错误。

## 4. 技术架构

### 4.1 后端 (Python)
- **核心**: FastAPI + LangGraph (StateGraph) + SubGraph 架构。
- **任务处理**: BackgroundTasks (开发) / Redis Stream + Worker (生产)。
- **存储**: SQLModel (SQLite/PostgreSQL) + ChromaDB (分层向量记忆) + Redis (缓存)。
- **搜索**: DuckDuckGo / Google。
- **观测**: LangSmith (Tracing & Eval)。
- **数据质量**: DataValidator 跨源校验。

### 4.2 前端 (React)
- **框架**: React 19 + Vite + Tailwind CSS。
- **状态**: TanStack Query (20 个 hooks)。
- **可视化**: TradingView Lightweight Charts + Recharts。
- **交互**: SSE (Server-Sent Events) 实时流。
- **认证**: @simplewebauthn/browser。

## 5. 迭代实施计划 (Implementation Roadmap)

### ✅ 阶段 1: Scout Agent 联网能力增强 (P0) — 已完成
- 集成搜索工具 (DuckDuckGo)。
- 优化 Query 理解与 Ticker 验证工作流。
- Scout → Planner 改造，实现自适应分析师选择。

### ✅ 阶段 2: 架构深度重构与工程化 (P1) — 已完成
- 实现并行分析师节点执行。
- SubGraph 架构重构（Analyst/Debate/Risk）。
- 分析分级 L1/L2。
- Redis Stream 任务队列 + Worker。

### ✅ 阶段 3: 市场差异化与专家子图 (P2) — 已完成
- A 股深度适配（政策分析、北向资金、龙虎榜、限售解禁）。
- 央行 NLP 分析。
- 跨资产联动监控。

### ✅ 阶段 4: 数据底座加固 (P2) — 已完成
- Redis 缓存集成。
- DataValidator 跨数据源校验。
- 数据源鲁棒性与自动重试机制。

### ✅ 阶段 5: 信任、回测与舆情 (P3) — 已完成
- 引入 BacktestAgent 与 SentimentAgent。
- 组合分析逻辑升级。
- 准确率追踪。

### ✅ 阶段 6: 智能进化与人机协同 (P4) — 已完成
- Agent 自我反思与分层记忆。
- Prompt 管理与优化系统。
- 动态 AI 配置系统。

### ✅ 阶段 7: 前端体验升级 (P5) — 已完成
- TradingView 图表集成。
- SSE 流式 UI 响应。
- Gemini TTS 音频简报。
- 12 页面 + 33 组件 + 20 Hooks。

### ✅ 阶段 8: 认证与安全 (P6) — 已完成
- JWT 用户认证。
- OAuth 2.0 (Google/GitHub)。
- WebAuthn/Passkey 免密认证。

## 6. 下一步规划 (Next Steps)

### 6.1 深度投研能力 — 🔮 计划中
- **多模态分析**: 电话会录音转录、财报图表 Vision 识别。
- **另类数据**: 专利监控、人才流向、AH 溢价套利。
- **产业链穿透**: 供应链知识图谱。

### 6.2 风险与组合管理 — 🔮 计划中
- **机构级建模**: 蒙特卡洛模拟、压力测试、VaR 预测。
- **筹码追踪**: 13F 机构持仓、内部人交易、L2 逐笔成交监控。

### 6.3 交互与自动化 — 🔮 计划中
- **自动化执行**: 模拟盘对接、网格交易 Agent。
- **AI 媒体化**: 双人对话播客、数字人视频简报。
- **智能 UI**: 动态组件生成、自然语言控制。
- **智能推送**: Telegram/微信机器人推送重大信号。

### 6.4 基础设施 — 🔮 计划中
- **日志聚合**: ELK/Loki 集成。
- **API 文档**: Swagger/OpenAPI 自动生成。
- **数据库迁移**: Alembic 集成。
- **前端 E2E 测试**: Playwright 集成。
